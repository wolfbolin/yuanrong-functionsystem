From 613a6535bef5e8edb881f67cf53187ba32bdf1ac Mon Sep 17 00:00:00 2001
Date: Mon, 26 Aug 2024 16:03:32 +0800
Subject: [PATCH] [Backport] fix CVE-2024-6197 for curl 8.8.0.
CVE: CVE-2024-6197
Reference:https://github.com/curl/curl/commit/3a537a4db9e65e545
---
 lib/vtls/x509asn1.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/lib/vtls/x509asn1.c b/lib/vtls/x509asn1.c
index 4564ea9..ed84032 100644
--- a/lib/vtls/x509asn1.c
+++ b/lib/vtls/x509asn1.c
@@ -390,7 +390,6 @@ utf8asn1str(struct dynbuf *to, int type, const char *from, const char *end)
         if(wc >= 0x00000800) {
           if(wc >= 0x00010000) {
             if(wc >= 0x00200000) {
-              free(buf);
               /* Invalid char. size for target encoding. */
               return CURLE_WEIRD_SERVER_REPLY;
             }
-- 
2.1.4

